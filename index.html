<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ê½ƒì‹¬ì–´ì„œ ë’·ëˆë²Œê¸°</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <div id="money-display">ğŸ’° 0ì›</div>
  <div id="upgrade-container">
    <div>í´ë¦­ ë‹¹ <span id="per-click">1</span>ì›</div>
    <div>ì—…ê·¸ë ˆì´ë“œ ë¹„ìš©: <span id="upgrade-cost">10</span>ì›</div>
    <button id="upgrade-btn">ì—…ê·¸ë ˆì´ë“œ</button>
    <div id="flower-btn-row">
      <button id="flower-btn">ê½ƒ ì‹¬ê¸°</button>
      <span style="margin:0 16px 0 8px;align-self:center;">ë¹„ìš©: <span id="flower-cost">20</span>ì›</span>
      <button id="flower-income-upgrade-btn">ê½ƒ ìˆ˜ìµ ì—…ê·¸ë ˆì´ë“œ</button>
      <span style="margin-left:8px;align-self:center;">ë¹„ìš©: <span id="flower-income-upgrade-cost">50</span>ì›</span>
    </div>
    <div id="flower-info-row" style="margin-top:8px;">
      <span>ê½ƒë‹¹ ìˆ˜ìµ: <span id="flower-income">1</span>ì›/ì´ˆ</span>
    </div>
  </div>

  <script>
    let money = 0;
    let perClick = 1;
    let upgradeCost = 10;
    let flowerCost = 20;
    let flowerIncome = 1;
    let flowerIncomeUpgradeCost = 50;

    function updateUI() {
      document.getElementById('money-display').innerText = `ğŸ’° ${money}ì›`;
      document.getElementById('per-click').innerText = perClick;
      document.getElementById('upgrade-cost').innerText = upgradeCost;
      document.getElementById('flower-cost').innerText = flowerCost;
      document.getElementById('flower-income').innerText = flowerIncome;
      document.getElementById('flower-income-upgrade-cost').innerText = flowerIncomeUpgradeCost;
    }

    // í´ë¦­ ì‹œ ëˆ ì¦ê°€
    document.body.addEventListener('click', (e) => {
      // ì—…ê·¸ë ˆì´ë“œ ë²„íŠ¼ í´ë¦­ì€ ë¬´ì‹œ
      if (e.target.id === 'upgrade-btn') return;
      money += perClick;
      updateUI();

      // í´ë¦­ ì• ë‹ˆë©”ì´ì…˜ ìƒì„±
      const plus = document.createElement('div');
      plus.id = 'plus-text';
      plus.style.left = `${e.pageX}px`;
      plus.style.top = `${e.pageY}px`;
      plus.textContent = `+${perClick}`;
      document.body.appendChild(plus);

      // ì• ë‹ˆë©”ì´ì…˜ ëë‚˜ë©´ ì œê±°
      setTimeout(() => {
        plus.remove();
      }, 700);
    });

    // ì—…ê·¸ë ˆì´ë“œ ë²„íŠ¼ í´ë¦­
    document.getElementById('upgrade-btn').addEventListener('click', (e) => {
      if (money >= upgradeCost) {
        money -= upgradeCost;
        perClick++;
        // ì—…ê·¸ë ˆì´ë“œ ë¹„ìš©ì€ 2ë°°ì”© ì¦ê°€
        upgradeCost = Math.floor(upgradeCost * 2);
        updateUI();
      } else {
        // ëˆì´ ë¶€ì¡±í•  ë•Œ íš¨ê³¼(ì˜ˆ: ë²„íŠ¼ í”ë“¤ë¦¼)
        const btn = document.getElementById('upgrade-btn');
        btn.style.transform = 'scale(1.1)';
        setTimeout(() => {
          btn.style.transform = '';
        }, 100);
      }
    });

    let flowerCount = 0;
    document.getElementById('flower-btn').addEventListener('click', () => {
      if (money >= flowerCost) {
        money -= flowerCost;
        flowerCost = Math.floor(flowerCost * 2);
        updateUI();
        const flower = document.createElement('img');
        flower.src = 'img/flower.png';
        flower.alt = 'flower';
        flower.style.position = 'absolute';
        flower.style.width = '180px';
        flower.style.height = '180px';
        flower.style.pointerEvents = 'none';
        // ì•„ë˜ìª½ 1/3 ì˜ì—­ì—ë§Œ ìƒì„±
        const minY = window.innerHeight * (2/3);
        const maxY = window.innerHeight - 70;
        const minX = 0;
        const maxX = window.innerWidth - 180;
        let x = Math.random() * (maxX - minX) + minX;
        const y = Math.random() * (maxY - minY) + minY;
        flower.style.left = `${x}px`;
        flower.style.top = `${y}px`;
        document.body.appendChild(flower);

        // ì¢Œìš°ë¡œ ê³„ì† ì›€ì§ì´ëŠ” ì• ë‹ˆë©”ì´ì…˜
        let direction = Math.random() < 0.5 ? 1 : -1;
        let speed = 1 + Math.random() * 1.5; // 1~2.5px/frame
        function moveFlower() {
          x += direction * speed;
          // í™”ë©´ ëì— ë‹¿ìœ¼ë©´ ë°©í–¥ ë°˜ì „
          if (x <= minX) {
            x = minX;
            direction = 1;
          } else if (x >= maxX) {
            x = maxX;
            direction = -1;
          }
          flower.style.left = `${x}px`;
          requestAnimationFrame(moveFlower);
        }
        moveFlower();

        // ê½ƒ ê°œìˆ˜ ì¦ê°€
        flowerCount++;
      } else {
        // ëˆì´ ë¶€ì¡±í•  ë•Œ íš¨ê³¼(ì˜ˆ: ë²„íŠ¼ í”ë“¤ë¦¼)
        const btn = document.getElementById('flower-btn');
        btn.style.transform = 'scale(1.1)';
        setTimeout(() => {
          btn.style.transform = '';
        }, 100);
      }
    });

    // ê½ƒ ìë™ ìˆ˜ìµ (1ì´ˆë§ˆë‹¤)
    setInterval(() => {
      if (flowerCount > 0) {
        // ëª¨ë“  ê½ƒì— ëŒ€í•´ ì• ë‹ˆë©”ì´ì…˜ í‘œì‹œ
        const flowers = document.querySelectorAll('img[alt="flower"]');
        flowers.forEach(flower => {
          // ê½ƒì˜ ìœ„ì¹˜ ê³„ì‚°
          const rect = flower.getBoundingClientRect();
          const plus = document.createElement('div');
          plus.className = 'plus-flower';
          plus.textContent = `+${flowerIncome}`;
          plus.style.position = 'absolute';
          plus.style.left = `${rect.left + rect.width/2 - 15 + window.scrollX}px`;
          plus.style.top = `${rect.top - 20 + window.scrollY}px`;
          plus.style.color = 'yellow';
          plus.style.fontWeight = 'bold';
          plus.style.fontSize = '28px';
          plus.style.pointerEvents = 'none';
          plus.style.animation = 'floatUp 0.7s ease-out';
          plus.style.zIndex = 2000;
          document.body.appendChild(plus);
          setTimeout(() => plus.remove(), 700);
        });
        money += flowerCount * flowerIncome;
        updateUI();
      }
    }, 1000);

    // ê½ƒ ìˆ˜ìµ ì—…ê·¸ë ˆì´ë“œ ë²„íŠ¼ í´ë¦­
    document.getElementById('flower-income-upgrade-btn').addEventListener('click', () => {
      if (money >= flowerIncomeUpgradeCost) {
        money -= flowerIncomeUpgradeCost;
        flowerIncome++;
        flowerIncomeUpgradeCost = Math.floor(flowerIncomeUpgradeCost * 2);
        updateUI();
      } else {
        // ëˆì´ ë¶€ì¡±í•  ë•Œ íš¨ê³¼(ì˜ˆ: ë²„íŠ¼ í”ë“¤ë¦¼)
        const btn = document.getElementById('flower-income-upgrade-btn');
        btn.style.transform = 'scale(1.1)';
        setTimeout(() => {
          btn.style.transform = '';
        }, 100);
      }
    });

    // ìƒˆì™€ ì•Œ ì†Œí™˜ í•¨ìˆ˜
    function spawnBirdAndEgg() {
      // ìƒˆ ìƒì„± (bird.png)
      const bird = document.createElement('img');
      bird.src = 'img/bird.png';
      bird.alt = 'bird';
      bird.style.position = 'absolute';
      bird.style.top = '0px';
      bird.style.width = '300px';
      bird.style.height = '195px';
      bird.style.zIndex = 4000;
      bird.style.pointerEvents = 'none';
      bird.style.userSelect = 'none';
      // ìƒˆê°€ ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ ë˜ëŠ” ì˜¤ë¥¸ìª½ì—ì„œ ì™¼ìª½ìœ¼ë¡œ ëœë¤í•˜ê²Œ ì´ë™
      const fromLeft = Math.random() < 0.5;
      let birdX = fromLeft ? -180 : window.innerWidth;
      bird.style.left = birdX + 'px';
      document.body.appendChild(bird);

      // ìƒˆ ì´ë™ ì†ë„ ë° ë°©í–¥
      const speed = 3 + Math.random() * 2; // px/frame
      const targetX = fromLeft ? window.innerWidth : -180;
      // ì•Œì„ ë–¨ì–´ëœ¨ë¦´ ìœ„ì¹˜(ìƒˆê°€ í™”ë©´ ì¤‘ê°„ì¯¤ì— ì™”ì„ ë•Œ)
      const eggDropX = fromLeft
        ? Math.random() * (window.innerWidth * 0.5) + window.innerWidth * 0.25
        : Math.random() * (window.innerWidth * 0.5) + window.innerWidth * 0.25;
      let eggDropped = false;

      function moveBird() {
        birdX += fromLeft ? speed : -speed;
        bird.style.left = birdX + 'px';
        // ì•Œ ë–¨ì–´ëœ¨ë¦¬ê¸°
        if (!eggDropped && ((fromLeft && birdX >= eggDropX) || (!fromLeft && birdX <= eggDropX))) {
          eggDropped = true;
          spawnEgg(birdX + 50, 80); // ìƒˆì˜ ì¤‘ì•™ ì•„ë˜ì—ì„œ ì•Œ ë–¨ì–´ëœ¨ë¦¼
        }
        // ìƒˆê°€ í™”ë©´ì„ ë²—ì–´ë‚˜ë©´ ì œê±°
        if ((fromLeft && birdX > window.innerWidth) || (!fromLeft && birdX < -180)) {
          bird.remove();
        } else {
          requestAnimationFrame(moveBird);
        }
      }
      moveBird();
    }

    // ì•Œ ë–¨ì–´ëœ¨ë¦¬ê¸° í•¨ìˆ˜
    function spawnEgg(x, startY) {
      const egg = document.createElement('img');
      egg.src = 'img/egg.png';
      egg.alt = 'egg';
      egg.style.position = 'absolute';
      egg.style.left = x + 'px';
      egg.style.top = startY + 'px';
      egg.style.height = '120px';
      egg.style.width = '';
      egg.style.objectFit = 'contain';
      egg.style.zIndex = 3500;
      egg.style.cursor = 'pointer';
      egg.style.userSelect = 'none';
      document.body.appendChild(egg);
      let y = startY;
      let velocity = 0;
      const gravity = 0.7;
      let landed = false;
      function fall() {
        velocity += gravity;
        y += velocity;
        egg.style.top = y + 'px';
        if (y < window.innerHeight - 120) {
          requestAnimationFrame(fall);
        } else {
          egg.style.top = (window.innerHeight - 120) + 'px';
          landed = true;
          // ì•Œì´ ë°”ë‹¥ì— ë‹¿ìœ¼ë©´ 2ì´ˆ í›„ ì‚¬ë¼ì§ (í´ë¦­ ì•ˆ í–ˆì„ ë•Œë§Œ)
          setTimeout(() => {
            if (document.body.contains(egg)) egg.remove();
          }, 10000);
        }
      }
      fall();

      // ì•Œ í´ë¦­ ì‹œ ë³´ìƒ
      egg.addEventListener('click', function onClick() {
        // ë³´ìƒ ê¸ˆì•¡: ê½ƒë‹¹ ìˆ˜ìµ x 100
        const reward = flowerIncome * 300;
        money += reward;
        updateUI();
        // ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
        const rect = egg.getBoundingClientRect();
        const plus = document.createElement('div');
        plus.textContent = `+${reward}ì›!`;
        plus.style.position = 'absolute';
        plus.style.left = `${rect.left + rect.width/2 - 30 + window.scrollX}px`;
        plus.style.userSelect = 'none';
        plus.style.top = `${rect.top - 20 + window.scrollY}px`;
        plus.style.color = '#00ffcc';
        plus.style.fontWeight = 'bold';
        plus.style.fontSize = '28px';
        plus.style.pointerEvents = 'none';
        plus.style.animation = 'floatUp 0.9s ease-out';
        plus.style.zIndex = 4001;
        document.body.appendChild(plus);
        setTimeout(() => plus.remove(), 900);
        // ì•Œ ì œê±°
        egg.remove();
      });
    }

    // ìƒˆ ì†Œí™˜ì„ ëœë¤í•œ ì‹œê°„ë§ˆë‹¤ ë°˜ë³µ
    function scheduleBird() {
      const min = 15000; // 15ì´ˆ
      const max = 60000; // 1ë¶„
      const delay = Math.random() * (max - min) + min;
      setTimeout(() => {
        spawnBirdAndEgg();
        scheduleBird();
      }, delay);
    }
    scheduleBird();

    updateUI();
  </script>

</body>
</html>
